<!DOCTYPE html>
<html>
<head>
  <title>PC Booking</title>
  <script src="https://cdn.jsdelivr.net/npm/@abhi2038/sort-util@1.0.0/dist/sort-util.min.js"></script>
</head>
<body>
  <h1>PC Booking</h1>
  <p>Available PCs: <span id="pcCount"></span></p>
  <table id="bookingDetails">
    <thead>
      <tr>
        <th>PC Number</th>
        <th>Time</th>
        <th>Payment</th>
        <th>Remaining Time</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <script>
    const bookingDetailsTable = document.getElementById('bookingDetails');
    const pcCountDisplay = document.getElementById('pcCount');

    // function to display booking details
    function displayBookingDetails() {
      // clear existing table rows
      bookingDetailsTable.innerHTML = '';

      // initialize PC count
      let pcCount = 0;

      // loop through all localStorage keys and display booking details for booked PCs
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('pc') && localStorage.getItem(key) !== null) {
          const bookingDetails = JSON.parse(localStorage.getItem(key));
          const pcNumber = key.substr(2);
          const remainingTime = Math.round((new Date(bookingDetails.timestamp).getTime() + bookingDetails.time * 60 * 60 * 1000 - Date.now()) / (60 * 60 * 1000) * 10) / 10;
          if (remainingTime > 0) {
            // create table row and cells
            const row = bookingDetailsTable.insertRow();
            const pcNumberCell = row.insertCell();
            const timeCell = row.insertCell();
            const paymentCell = row.insertCell();
            const remainingTimeCell = row.insertCell();

            // set cell values
            pcNumberCell.innerText = pcNumber;
            timeCell.innerText = bookingDetails.time + ' hours';
            paymentCell.innerText = bookingDetails.payment;
            remainingTimeCell.innerText = remainingTime + ' hours';

            // increment PC count
            pcCount++;
          } else {
            // remove expired booking details from localStorage
            localStorage.removeItem(key);
          }
        }
      }

      // update PC count display
      pcCountDisplay.innerText = pcCount;
    }

    // call displayBookingDetails function on page load and every 10 seconds
    displayBookingDetails();
    setInterval(displayBookingDetails, 10000);

    // function to book a PC
    function bookPC(pcNumber, time, payment) {
      const key = 'pc' + pcNumber;
      const bookingDetails = {
        timestamp: new Date().toISOString(),
        time: time,
        payment: payment
      };
      localStorage.setItem(key, JSON.stringify(bookingDetails));
    }

    // example usage of bookPC function
    bookPC(1, 2, 10.99);
  </script>
</body>
</html>
